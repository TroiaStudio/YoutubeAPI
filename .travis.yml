language: php

php:
  - 7.0
  - 7.1
  - 7.2
  - 7.3

matrix:
  allow_failures:
    - php: 7.0
    - php: 7.3

install:
    - composer create-project galek/coding-standard temp/coding-standard

script:
  - vendor/bin/tester -p php-cgi tests
  - vendor/bin/phpstan analyse -l max ./src/
  - temp/coding-standard/ecs check src tests --config temp/coding-standard/coding-standard-php71.yml

after_failure:
  - for i in $(find ./tests -name \*.actual); do echo "--- $i"; cat $i; echo; echo; done

before_script:
  - travis_retry composer update --no-interaction